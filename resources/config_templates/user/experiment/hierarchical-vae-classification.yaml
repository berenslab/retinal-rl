# @package _global_

# Hierarchical VAE classification experiment
# Based on classification-medium but with multi-level VAE bottlenecks

defaults:
  - override /brain: hierarchical-vae-classifier
  - override /dataset: cifar10
  - override /optimizer: hierarchical-vae-classification

# System configuration
framework: classification
vision_size: 128
image_rescale_range: [1, 4]
vision_height: ${vision_size}
vision_width: ${vision_size}

# Training parameters
weight_decay: 0.0001
activation: gelu

# Architecture parameters (remove channel bottlenecks)
bp_stride: 2
rgc_stride: 2
thalamus_stride: 1
v1_stride: 2
bp_kernel_size: 14
rgc_kernel_size: 8
lgn_kernel_size: 3
v1_kernel_size: 6

# Data augmentation
shot_noise_transform: true
contrast_noise_transform: true
brightness_noise_transform: true
blur_noise_transform: true
layer_norm: true
affine_norm: true

# Loss weights
recon_weight: 0.1  # Reduced from classification-medium

# KL divergence weights (start conservative)
optic_kl_weight: 0.01
v1_kl_weight: 0.01
pfc_kl_weight: 0.01

# KL start epochs (progressive introduction)
optic_kl_start_epoch: 0    # Start immediately
v1_kl_start_epoch: 25      # Start after 25 epochs
pfc_kl_start_epoch: 50     # Start after 50 epochs
