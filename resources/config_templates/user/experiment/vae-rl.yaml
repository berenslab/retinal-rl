# @package _global_
defaults:
  - _self_
  - override /dataset: rl-base
  - override /brain: vae-rl
  - override /optimizer: vae-rl

framework: rl

logging:
  wandb_project: retinal-rl-recon_weight
  use_wandb: True

### Interpolation Parameters ###

# This is a free list of parameters that can be interpolated by the subconfigs
# in sweep, dataset, brain, and optimizer. A major use for this is interpolating
# values in the subconfigs, and then looping over them in a sweep.

env_name: gathering-apples

vision_height: ${dataset.vision_height}
vision_width: ${dataset.vision_width}

learning_rate: 0.0001
weight_decay: 0.00001

activation: "gelu"

bottleneck_chans: 8

# Stride configuration
bp_stride: 3
rgc_stride: 3
thalamus_stride: 1
v1_stride: 3

# Kernel sizes
bp_kernel_size: 15
rgc_kernel_size: 11
lgn_kernel_size: 3
v1_kernel_size: 9

# Norms
layer_norm: True
affine_norm: True

# Noise transforms
shot_noise_transform: True
contrast_noise_transform: True
brightness_noise_transform: True
blur_noise_transform: True

# Loss Weights
policy_factor: 1
exploration_factor: 0.001
value_factor: 0.5
reconstruction_factor: 0.001 # factor calculated through expected value of 0.4 and sum of rl losses being approximately 0.005
recon_weight: 0.0
recon_weight_retina: ${recon_weight}
recon_weight_thalamus: ${recon_weight}
recon_weight_cortex: ${recon_weight}

bottle_weight: 0.0

samplefactory:
  num_workers: 2
  num_envs_per_worker: 2
  analysis_freq_start: 1000000
  analysis_freq_end: 250000000
  use_rnn: False
